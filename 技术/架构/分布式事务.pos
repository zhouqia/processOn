{"diagram":{"image":{"height":200,"pngdata":"iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsUlEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8GXHmAAFMgHIEAAAAAElFTkSuQmCC","width":200,"y":0,"x":0},"elements":{"id":"root","structure":"mind_free","leftChildren":[],"title":"分布式事务(2PC和3PC)","root":true,"theme":"theme3","children":[{"id":"dcae4a929116","title":"2PC","children":[{"id":"ab56174ff81b","title":"过程","children":[{"id":"c511128b12e5","title":"协调者发起投票 - 执行者返回预处理结果","children":[{"id":"323e4b462bb5","title":"阻塞事务","parent":"c511128b12e5","children":[]}],"parent":"ab56174ff81b"},{"id":"38bfaaf1fbc4","title":"协调者发起执行(commit/abort) - 根据统计的投票结果决定是否执行","children":[],"parent":"ab56174ff81b"}],"parent":"dcae4a929116"},{"id":"c01eb697dada","title":"超时机制","parent":"dcae4a929116","children":[{"id":"3164ef25b4c7","title":"只针对协调者","parent":"c01eb697dada","children":[]},{"id":"5ae03757d847","title":"当一定时间内没有接收到执行者的反馈结果，则默认执行失败","parent":"c01eb697dada","children":[]}]},{"id":"dc0eae6d827c","title":"缺点","children":[{"id":"19f29b83e9e4","title":"协调者统计投票结果阶段出现异常，执行者的事务被阻塞","children":[],"parent":"dc0eae6d827c"},{"id":"95c4a28ff383","title":"协调者发起执行(commit)后，部分执行者是否执行及执行结果无法控制","children":[],"parent":"dc0eae6d827c"},{"id":"5fc9017ee18c","title":"协调者发起执行后，协调者和部分执行者出现异常，事务的执行情况无法统计","children":[],"parent":"dc0eae6d827c"}],"parent":"dcae4a929116"}],"parent":"root"},{"id":"f55860a1219b","title":"3PC","children":[{"id":"5d656e8f2393","title":"过程","children":[{"id":"433b1995e292","title":"canCommit 协调者发起投票 - 执行者返回结果(是否可执行) - 未开启事务","children":[],"parent":"5d656e8f2393"},{"id":"982e4bf7087d","title":"preCommit 协调者统计投票情况 - 发起执行事务命令 - 事务阻塞","children":[],"parent":"5d656e8f2393"},{"id":"c9faadc7ee6b","title":"commit 协调者根据执行者的执行结果，确定是否提交事务 - 通知执行者是否提交事务","children":[],"parent":"5d656e8f2393"}],"parent":"f55860a1219b"},{"id":"f1e85f59563f","title":"超时机制","children":[{"id":"b3c11a7a0008","title":"协调者和执行者都有超时机制<br>","children":[],"parent":"f1e85f59563f"},{"id":"3fe1e2bf9f9a","title":"当协调者一定时间内没有接收到执行者的反馈结果，则默认执行失败","parent":"f1e85f59563f","children":[]},{"id":"cde4f2ab7a7c","title":"执行者返回canCommit结果之后，一直没有接受到协调者后面的请求，默认超时abort<br>","children":[],"parent":"f1e85f59563f"},{"id":"a54885ce47d7","title":"执行者返回preCommit结果之后，一直没有接受到协调者后面的请求，默认超时commit","children":[],"parent":"f1e85f59563f"}],"parent":"f55860a1219b"}],"parent":"root"},{"id":"912399ab2ff5","title":"分布式事务","free":true,"parent":"root","children":[{"id":"a791a67cd5d2","title":"CAP理论 - 分布式系统设计基础理论","children":[{"id":"7a0335c2b1d3","title":"特性","children":[{"id":"6a4c26833711","title":"一致性","children":[],"parent":"7a0335c2b1d3"},{"id":"b6d24ab41ce5","title":"可用性","children":[],"parent":"7a0335c2b1d3"},{"id":"f32b9b9d3cc1","title":"分区容错性","children":[],"parent":"7a0335c2b1d3"}],"parent":"a791a67cd5d2","collapsed":false},{"id":"19047d295345","title":"举例","children":[{"id":"3921aac9a841","title":"CP - zk","children":[],"parent":"19047d295345"},{"id":"f2a9ebc2ef90","title":"AP - eureka","children":[],"parent":"19047d295345"},{"id":"bf9417f2865d","title":"CA - 传统单机db","children":[],"parent":"19047d295345"}],"parent":"a791a67cd5d2"},{"id":"3e5c1e97209e","title":"基于CAP理论的数据库理论模型","children":[{"id":"0af3d911cf9f","title":"单机db - ACID模型<br>","parent":"3e5c1e97209e","children":[{"id":"e28d412a96e2","title":"A - 原子性","children":[],"parent":"0af3d911cf9f"},{"id":"d8711906dd7c","title":"C - 一致性","children":[],"parent":"0af3d911cf9f"},{"id":"ecbae3eaa036","title":"I - 隔离性<br>","children":[],"parent":"0af3d911cf9f"},{"id":"2af63f8f4d54","title":"D - 持久性","children":[],"parent":"0af3d911cf9f"}],"summaries":[]},{"id":"5ed5e34e98da","title":"分布式db - BASE模型(基于CAP理论，ACID变种)","summaries":[],"children":[{"id":"93f1fbde2000","title":"基本可用","parent":"5ed5e34e98da","children":[]},{"id":"dad80322da56","title":"软状态","parent":"5ed5e34e98da","children":[]},{"id":"bba0b8865050","title":"最终一致","parent":"5ed5e34e98da","children":[]}],"parent":"3e5c1e97209e"}],"parent":"a791a67cd5d2"}],"parent":"912399ab2ff5"}],"pos":{"y":10135.800003051758,"x":9799.400009155273}}]}},"meta":{"id":"5fb37a09e401fd3d93e2a443","member":"5b8deb14e4b06fc64ae2c0eb","exportTime":"2020-11-18 16:33:29","diagramInfo":{"category":"mind_free","title":"分布式事务","created":"2020-11-17 15:21:45","creator":"5b8deb14e4b06fc64ae2c0eb","modified":"2020-11-17 16:21:51"},"type":"ProcessOn Schema File","version":"1.0"}}